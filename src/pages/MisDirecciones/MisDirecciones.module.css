.screen {
  height: 100dvh;
  display: grid;
  grid-template-rows: auto 1fr auto; /* header | main | bottomnav */
  background: #fff;
  overflow: hidden; /* evita scroll global */
}

.header {
  padding: 12px 14px 6px;
  border-bottom: 1px solid #f0f3f5;
}
.title { font-size: 1.04rem; font-weight: 900; color: #0f2410; }
.subtitle { font-size: .9rem; color: #456; }

/* padding-bottom considera la barra de acci√≥n y el bottomnav */
.main {
  padding: 10px 12px calc(env(safe-area-inset-bottom, 0) + 64px + 56px);
  overflow: auto;
  display: grid;
  gap: 12px;
}

.group {
  display: grid;
  gap: 8px;
  overflow: visible;              /* üëà deja ‚Äúasomar‚Äù la animaci√≥n */
}
.groupTitle { font-weight: 800; color: #0f2410; font-size: .95rem; }

.list {
  display: grid;
  gap: 10px;
  overflow: visible;              /* üëà importante para el ‚Äúsalto‚Äù */
}

.empty { display: grid; place-items: center; }
.emptyCard {
  border: 1px solid #e6edf0;
  border-radius: 14px;
  padding: 16px;
  background: #fafcfd;
  color: #345;
  text-align: center;
  max-width: 420px;
}

/* ===== Barra inferior de acci√≥n ===== */
.actionBar {
  position: fixed;
  left: 0; right: 0; bottom: calc(58px + env(safe-area-inset-bottom, 0)); /* arriba del bottomnav */
  padding: 8px 12px;
  background: linear-gradient(180deg, rgba(255,255,255,.0), rgba(255,255,255,.9) 30%, #fff 100%);
  backdrop-filter: blur(2px);
  display: grid;
  place-items: center;
  z-index: 21; /* por encima del contenido, debajo del sheet (30) */
}

.addBtn {
  padding: 12px 14px;
  border-radius: 12px;
  font-weight: 900;
  background: linear-gradient(180deg, #2e7d32, #1b5e20);
  color: #fff;
  border: 1px solid #1b5e20;
  box-shadow: 0 10px 26px rgba(27,94,32,.22);
  width: min(520px, calc(100% - 24px));
}

/* ===== Overlay & Sheet ===== */
.overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,.35);
  backdrop-filter: blur(2px);
  z-index: 29; /* debajo del sheet, arriba del contenido */
}

.sheet {
  position: fixed;
  left: 0; right: 0; bottom: 0;
  background: #fff;
  border-top-left-radius: 16px;
  border-top-right-radius: 16px;
  box-shadow: 0 -12px 40px rgba(0,0,0,.22);
  z-index: 30; /* por encima del BottomNav (que suele tener 20) */
  display: grid;
  grid-template-rows: auto 1fr auto;
  max-height: 86dvh;
}

.sheetHeader {
  padding: 10px 12px;
  display: grid;
  grid-template-columns: 24px 1fr 24px;
  align-items: center;
}
.grabber {
  width: 28px; height: 4px;
  background: #e6edf0; border-radius: 999px; justify-self: center;
}
.sheetTitle { text-align: center; font-weight: 900; color: #0f2410; }
.closeBtn {
  border: 1px solid #e6edf0; background: #f6f8fa;
  border-radius: 8px; width: 28px; height: 28px;
}

.sheetBody {
  padding: 8px 12px;
  display: grid;
  gap: 8px;
  overflow: auto;
}
.field { display: grid; gap: 4px; }
.label { font-size: .86rem; color: #345; }
.input, .textarea {
  border: 1px solid #e6edf0; border-radius: 10px; padding: 8px 10px;
  font-size: .94rem; outline: none;
}
.textarea { resize: vertical; }

.row2 { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }

.mapWrap { border: 1px solid #e6edf0; border-radius: 12px; overflow: hidden; }
.map { width: 100%; height: 180px; }

.coords { display: grid; gap: 2px; font-size: .82rem; color: #456; }

.chk { display: grid; grid-auto-flow: column; gap: 8px; align-items: center; color: #234; }

.sheetActions {
  display: grid; grid-template-columns: 1fr 1.2fr; gap: 10px;
  padding: 10px 12px 14px; border-top: 1px solid #eef2f5; background: #fff;
}
.cancelBtn {
  padding: 10px; border-radius: 12px; font-weight: 800;
  background: #f3f5f7; color: #223; border: 1px solid #e6eaef;
}
.saveBtn {
  padding: 10px; border-radius: 12px; font-weight: 800;
  background: linear-gradient(180deg, #2e7d32, #1b5e20);
  color: #fff; border: 1px solid #1b5e20;
  box-shadow: 0 6px 14px rgba(27,94,32,.18);
}

/* ==== Animaci√≥n de swap visual (mejorada) ==== */
.cardWrap {
  position: relative;             /* para stacking y transform */
  will-change: transform, opacity, filter;
  overflow: visible;
}

.animPick {
  z-index: 2;                     /* por encima del resto */
  animation: pickUp .52s cubic-bezier(.22,.9,.24,1) forwards;
  filter: drop-shadow(0 12px 24px rgba(0,0,0,.12));
}

@keyframes pickUp {
  0%   { transform: translateY(0) scale(1); opacity: 1; }
  60%  { transform: translateY(calc(-130% - 12px)) scale(.98); opacity: .8; }
  100% { transform: translateY(calc(-150% - 12px)) scale(.96); opacity: 0; }
}

/* La actual hace un drop m√°s perceptible */
.animDrop {
  animation: dropIn .54s cubic-bezier(.16,.84,.44,1) both;
  filter: drop-shadow(0 8px 18px rgba(0,0,0,.10));
}
@keyframes dropIn {
  0%   { transform: translateY(-14px); opacity: 0; }
  60%  { transform: translateY(2px);   opacity: 1; }
  100% { transform: translateY(0);     opacity: 1; }
}
